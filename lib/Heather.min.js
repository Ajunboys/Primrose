/*
  Heather v1.0.0 2015-04-24
  
  Copyright (C) 2015  []
  https://www.heatherapps.com
  https://github.com/capnmidnight/Heather.git
*/
function reloadPage(){document.location=document.location.href}function cascadeElement(a,b,c){var d=null;if(null===a?(d=document.createElement(b),d.id=a="auto_"+b+Date.now()):void 0===c||a instanceof c?d=a:"string"==typeof a&&(d=document.getElementById(a),null===d?(d=document.createElement(b),d.id=a):d.tagName!==b.toUpperCase()&&(d=null)),null===d)throw new Error(a+" does not refer to a valid "+b+" element.");return d.innerHTML="",d}function findEverything(a,b){a=a||document,b=b||{};for(var c=a.querySelectorAll("*"),d=0;d<c.length;++d){var e=c[d];e.id&&e.id.length>0&&(b[e.id]=e,e.parentElement&&(e.parentElement[e.id]=e))}return b}function makeHidingContainer(a,b){var c=cascadeElement(a,"div",window.HTMLDivElement);return c.style.position="absolute",c.style.left=0,c.style.top=0,c.style.width=0,c.style.height=0,c.style.overflow="hidden",c.appendChild(b),c}function arr(a,b,c){return Array.prototype.slice.call(a,b,c)}function map(a,b){return Array.prototype.map.call(a,b)}function reduce(a,b,c){return Array.prototype.reduce.call(a,b,c)}function filter(a,b){return Array.prototype.filter.call(a,b)}function ofType(a,b){return"function"==typeof b?filter(a,function(a){return a instanceof b}):filter(a,function(a){return typeof a===b})}function agg(a,b,c){return"function"!=typeof b&&(b=function(a,b){return b[a]}.bind(window,b)),a.map(b).reduce(c)}function add(a,b){return a+b}function sum(a,b){return agg(a,b,add)}function group(a,b,c){var d=[],e=a.slice();e.sort(function(a,c){var d=b?b(a):a,e=b?b(c):c;return e>d?-1:d>e?1:0});for(var f=0;f<e.length;++f){var g=e[f],h=b?b(g):g,i=c?c(g):g;(0===d.length||d[d.length-1].key!==h)&&d.push({key:h,values:[]}),d[d.length-1].values.push(i)}return d}function isNumber(a){return!isNaN(a)}function sigfig(a,b){var c=Math.pow(10,b),d=(Math.round(a*c)/c).toString();if(b>0){var e=d.indexOf(".");for(-1===e&&(d+=".",e=d.length-1);d.length-e-1<b;)d+="0"}return d}function getSetting(a,b){if(window.localStorage){var c=window.localStorage.getItem(a);if(c)try{return JSON.parse(c)}catch(d){console.error("getSetting",a,c,typeof c,d)}}return b}function setSetting(a,b){if(window.localStorage&&b)try{window.localStorage.setItem(a,JSON.stringify(b))}catch(c){console.error("setSetting",a,b,typeof b,c)}}function deleteSetting(a){window.localStorage&&window.localStorage.removeItem(a)}function readForm(a){var b={};if(a)for(var c in a){var d=a[c];"INPUT"!==d.tagName&&"SELECT"!==d.tagName||d.dataset&&d.dataset.skipcache||("text"===d.type||"password"===d.type||"SELECT"===d.tagName?b[c]=d.value:("checkbox"===d.type||"radio"===d.type)&&(b[c]=d.checked))}return b}function writeForm(a,b){if(b)for(var c in a){var d=a[c];null===b[c]||void 0===b[c]||"INPUT"!==d.tagName&&"SELECT"!==d.tagName||d.dataset&&d.dataset.skipcache||("text"===d.type||"password"===d.type||"SELECT"===d.tagName?d.value=b[c]:("checkbox"===d.type||"radio"===d.type)&&(d.checked=b[c]))}}function isFullScreenMode(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}function requestFullScreen(a,b){if(b||(b=a,a=null),isFullScreenMode())b&&b();else{document.documentElement.requestFullscreen(a?{vrDisplay:a}:window.Element.ALLOW_KEYBOARD_INPUT);var c=setInterval(function(){isFullScreenMode()&&(clearInterval(c),screen.lockOrientation("landscape-primary"),b&&b())},1e3)}}function exitFullScreen(){isFullScreenMode()&&document.exitFullscreen()}function toggleFullScreen(){document.documentElement.requestFullscreen&&(isFullScreenMode()?exitFullScreen():requestFullScreen())}function addFullScreenShim(){function a(){c.forEach(function(a){a.events.forEach(function(c){a.elem.removeEventListener(c,b)})})}function b(b){requestFullScreen(a)}var c=arr(arguments);c=c.map(function(a){return{elem:a,events:help(a).events}}),c.forEach(function(a){a.events.forEach(function(c){c.indexOf("fullscreenerror")<0&&a.elem.addEventListener(c,b,!1)})})}function isPointerLocked(){return!!(document.pointerLockElement||document.webkitPointerLockElement||document.mozPointerLockElement)}function SeansVREffect(a,b){"use strict";function c(a,b){a.makeTranslation(b.x,b.y,b.z)}function d(a,b){a.min.set(b.x,b.y),a.max.set(b.x+b.width,b.y+b.height)}var e=[new THREE.Matrix4,new THREE.Matrix4],f=[new THREE.Box2,new THREE.Box2];this.setHMD=function(a){a.getEyeParameters?(this.left=a.getEyeParameters("left"),this.right=a.getEyeParameters("right")):(this.left={renderRect:a.getRecommendedEyeRenderRect("left"),eyeTranslation:a.getEyeTranslation("left"),recommendedFieldOfView:a.getRecommendedEyeFieldOfView("left")},this.right={renderRect:a.getRecommendedEyeRenderRect("right"),eyeTranslation:a.getEyeTranslation("right"),recommendedFieldOfView:a.getRecommendedEyeFieldOfView("right")}),c(e[0],this.left.eyeTranslation),c(e[1],this.right.eyeTranslation),d(f[0],this.left.renderRect),d(f[1],this.right.renderRect)},this.setHMD(b),this.render=function(b,c,d,g){void 0===c.parent&&c.updateMatrixWorld(),c.projectionMatrix=this.FovToProjection(this.left.recommendedFieldOfView,!0,c.near,c.far),a.renderStereo(b,c,d,g,e,f)},this.FovToNDCScaleOffset=function(a){var b=2/(a.leftTan+a.rightTan),c=(a.leftTan-a.rightTan)*b*.5,d=2/(a.upTan+a.downTan),e=(a.upTan-a.downTan)*d*.5;return{scale:[b,d],offset:[c,e]}},this.FovPortToProjection=function(a,b,c,d){b=void 0===b?!0:b,c=void 0===c?.01:c,d=void 0===d?1e4:d;var e=b?-1:1,f=this.FovToNDCScaleOffset(a),g=(new THREE.Matrix4).set(f.scale[0],0,f.offset[0]*e,0,0,f.scale[1],-f.offset[1]*e,0,0,0,d/(c-d)*-e,d*c/(c-d),0,0,e,0);return g},this.FovToProjection=function(a,b,c,d){var e={upTan:Math.tan(a.upDegrees*Math.PI/180),downTan:Math.tan(a.downDegrees*Math.PI/180),leftTan:Math.tan(a.leftDegrees*Math.PI/180),rightTan:Math.tan(a.rightDegrees*Math.PI/180)};return this.FovPortToProjection(e,b,c,d)}}function InsideSphereGeometry(a,b,c,d,e,f,g){"use strict";THREE.Geometry.call(this),this.type="SphereGeometry",this.parameters={radius:a,widthSegments:b,heightSegments:c,phiStart:d,phiLength:e,thetaStart:f,thetaLength:g},a=a||50,b=Math.max(3,Math.floor(b)||8),c=Math.max(2,Math.floor(c)||6),d=void 0!==d?d:0,e=void 0!==e?e:2*Math.PI,f=void 0!==f?f:0,g=void 0!==g?g:Math.PI;var h,i,j=[],k=[];for(i=0;c>=i;i++){var l=[],m=[];for(h=b;h>=0;h--){var n=h/b,o=i/c,p=new THREE.Vector3;p.x=-a*Math.cos(d+n*e)*Math.sin(f+o*g),p.y=a*Math.cos(f+o*g),p.z=a*Math.sin(d+n*e)*Math.sin(f+o*g),this.vertices.push(p),l.push(this.vertices.length-1),m.push(new THREE.Vector2(1-n,1-o))}j.push(l),k.push(m)}for(i=0;c>i;i++)for(h=0;b>h;h++){var q=j[i][h+1],r=j[i][h],s=j[i+1][h],t=j[i+1][h+1],u=this.vertices[q].clone().normalize(),v=this.vertices[r].clone().normalize(),w=this.vertices[s].clone().normalize(),x=this.vertices[t].clone().normalize(),y=k[i][h+1].clone(),z=k[i][h].clone(),A=k[i+1][h].clone(),B=k[i+1][h+1].clone();Math.abs(this.vertices[q].y)===a?(y.x=(y.x+z.x)/2,this.faces.push(new THREE.Face3(q,s,t,[u,w,x])),this.faceVertexUvs[0].push([y,A,B])):Math.abs(this.vertices[s].y)===a?(A.x=(A.x+B.x)/2,this.faces.push(new THREE.Face3(q,r,s,[u,v,w])),this.faceVertexUvs[0].push([y,z,A])):(this.faces.push(new THREE.Face3(q,r,t,[u,v,x])),this.faceVertexUvs[0].push([y,z,B]),this.faces.push(new THREE.Face3(r,s,t,[v.clone(),w,x.clone()])),this.faceVertexUvs[0].push([z.clone(),A,B.clone()]))}this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,a)}function help(a){var b={},c={},d=[];if(a){for(var e in a)0!==e.indexOf("on")||a===navigator&&"onLine"===e?"function"==typeof a[e]?b[e]=a[e]:c[e]=a[e]:d.push(e.substring(2));var f=typeof a;if("function"===f)f=a.toString().match(/(function [^(]*)/)[1];else if("object"===f)if(f=null,a.constructor&&a.constructor.name)f=a.constructor.name;else{for(var g=[{prefix:"",obj:window}],h=[];g.length>0&&null===f;){var i=g.shift();i.___traversed___=!0,h.push(i);for(e in i.obj){var j=i.obj[e];if(j)if("function"==typeof j){if(j.prototype&&a instanceof j){f=i.prefix+e;break}}else j.___tried___||g.push({prefix:i.prefix+e+".",obj:j})}}h.forEach(function(a){delete a.___traversed___})}return a={type:f,events:d,functions:b,properties:c}}console.warn("Object was falsey.")}function copyObject(a,b){for(var c=[{dest:a,source:b}];c.length>0;){var d=c.pop();b=d.source,a=d.dest;for(var e in b)b.hasOwnProperty(e)&&("object"!=typeof b[e]?a[e]=b[e]:(a[e]||(a[e]={}),c.push({dest:a[e],source:b[e]})))}}function inherit(a,b){a.prototype=Object.create(b.prototype),a.prototype.constructor=a}function makeURL(a,b){var c=[];for(var d in b)b.hasOwnProperty(d)&&"function"!=typeof b[d]&&c.push(encodeURIComponent(d)+"="+encodeURIComponent(b[d]));return a+"?"+c.join("&")}function XHR(a,b,c,d,e,f,g){var h=new XMLHttpRequest;h.onerror=e,h.onabort=e,h.onprogress=d,h.onload=function(){h.status<400?f&&f(h.response):e&&e()},h.open(b,a),c&&(h.responseType=c),g?(h.setRequestHeader("Content-Type","application/json;charset=UTF-8"),h.send(JSON.stringify(g))):h.send()}function GET(a,b,c,d,e){b=b||"text";var f=e&&d&&c,g=e&&d||d&&c,h=e||d||c;XHR(a,"GET",b,f,g,h)}function POST(a,b,c,d,e,f){var g=f&&e&&d,h=f&&e||e&&d,i=f||e||d;XHR(a,"POST",c,g,h,i)}function getObject(a,b,c,d){var e=d&&c&&b,f=d&&c||c&&b,g=d||c||b;GET(a,"json",e,f,g)}function sendObject(a,b,c,d,e){POST(a,b,"json",e&&d&&c,e&&d||d&&c,e||d||c)}var isMobile=function(a){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substring(0,4))}(navigator.userAgent||navigator.vendor||window.opera),isiOS=/Apple-iP(hone|od|ad)/.test(navigator.userAgent||""),isOSX=/Macintosh/.test(navigator.userAgent||""),isWindows=/Windows/.test(navigator.userAgent||""),isOpera=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,isFirefox="undefined"!=typeof window.InstallTrigger,isSafari=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,isChrome=!!window.chrome&&!isOpera,isIE=!1||!!document.documentMode,fmt=function(){function a(a,b){return b.replace(/( AM| PM|$)/,function(b,c){return(a.getMilliseconds()/1e3).toString().substring(1)+c})}function b(b){var c=/\$(0*)(\d+)(?:\.(0+))?/g,d=arguments;return"string"!=typeof b&&(b=b.toString()),b.replace(c,function(b,c,e,f){if(e=parseInt(e,10),e>=0&&e<d.length){var g=d[e];if(null!==g&&void 0!==g){if(g instanceof Date&&f){switch(f.length){case 1:g=g.getYear();break;case 2:g=g.getMonth()+1+"/"+g.getYear();break;case 3:g=g.toLocaleDateString();break;case 4:g=a(g,g.toLocaleTimeString());break;case 5:case 6:g=g.toLocaleString();break;default:g=a(g,g.toLocaleString())}return g}if(g=f&&f.length>0?sigfig(g,f.length):g.toString(),c&&c.length>0)for(var h=new RegExp("^\\d{"+(c.length+1)+"}(\\.\\d+)?");!h.test(g);)g="0"+g;return g}}return void 0})}return b}(),px=fmt.bind(this,"$1px"),pct=fmt.bind(this,"$1%"),ems=fmt.bind(this,"$1em"),exitPointerLock=(document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock||function(){}).bind(document),requestPointerLock=(document.documentElement.requestPointerLock||document.documentElement.webkitRequestPointerLock||document.documentElement.mozRequestPointerLock||function(){}).bind(document.documentElement);"undefined"!=typeof window.THREE&&(InsideSphereGeometry.prototype=Object.create(THREE.Geometry.prototype),InsideSphereGeometry.prototype.constructor=InsideSphereGeometry);var Heather={};navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||function(){},navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia||function(){},window.RTCPeerConnection=window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection||function(){},window.RTCIceCandidate=window.RTCIceCandidate||window.mozRTCIceCandidate||function(){},window.RTCSessionDescription=window.RTCSessionDescription||window.mozRTCSessionDescription||function(){},window.Element.prototype.requestPointerLock=window.Element.prototype.requestPointerLock||window.Element.prototype.webkitRequestPointerLock||window.Element.prototype.mozRequestPointerLock||function(){},window.Element.prototype.requestFullscreen=window.Element.prototype.requestFullscreen||window.Element.prototype.webkitRequestFullscreen||window.Element.prototype.mozRequestFullScreen||window.Element.prototype.msRequestFullscreen||function(){},window.Document.prototype.exitFullscreen=window.Document.prototype.exitFullscreen||window.Document.prototype.webkitExitFullscreen||window.Document.prototype.mozCancelFullScreen||window.Document.prototype.msExitFullscreen||function(){},screen.lockOrientation=screen.lockOrientation||screen.mozLockOrientation||screen.msLockOrientation||function(){};var reverse=function(){function a(d){d=d.replace(b,function(b,c,d){return a(d)+c}).replace(c,"$2$1");for(var e="",f=d.length-1;f>=0;--f)e+=d[f];return e}var b=/(<%= allExceptCombiningMarks %>)(<%= combiningMarks %>+)/g,c=/(<%= highSurrogates %>)(<%= lowSurrogates %>)/g;return a}();Heather.VERSION="v1.0.0";